<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="">
        <link rel="icon" href="/favicon.ico">

        <title>BE-RP: Prediction Markets</title>


        <link rel="stylesheet" href="/stylesheets/bootstrap.min.css">

        <!-- Custom styles for this template -->
        <link rel="stylesheet" href="/stylesheets/market.css">
        <link rel="stylesheet" href="/stylesheets/style.css">
        <link rel="stylesheet" href="/stylesheets/jqmath-0.4.0.css">


    </head>

    <body>
        <!-- Navbar -->
        <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/index.html">BE-RP: Prediction markets</a>
                </div>
                <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <li id="home"><a href="/index.html">Home</a></li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Replication info<span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="/repdetails.html">Project details</a></li>
                                <li id="studies"><a href="/studies.html">Included studies</a></li>
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Market info<span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="/techdetails.html">Technical details</a></li>
                                <li><a href="/interface.html">Market interface</a></li>
                                <li class="active"><a href="/calculator.html">Market calculator</a></li>
                            </ul>
                        </li>
                        <li id="participate"><a href="/participate.html">Participate</a></li>
                    </ul>
                </div><!--/.navbar-collapse -->
            </div>
        </div>

        <div class="container">
            <div class="page-header">
                <h1>Market calculator</h1>
            </div>
            <!-- Example row of columns -->
            <div class="row">
                <div class="col-md-4 col-sm-6">
                    <h4>Input</h4>
                    <form id="transaction">
                        <p>Type of transaction:<br>
                            <select type="multiple" id="type">
                                <option value="invest" selected="selected">Invest points</option>
                                <option value="sell">Sell invested points</option>
                            </select>
                        </p>
                    </form>
                    <table id="invest">
                        <tr class="autoWidth">
                            <td>Current market score for Yes:</td>
                            <td>
                                <div class="input-group-sm">
                                    <input id="sc" class="form-control maxInput" type="number" min="0" max ="1" step="0.1" value="0.5">
                                </div>
                            </td> 
                        </tr>
                        <tr class="autoWidth spaceSmOver">
                            <td>Point investment:</td>
                            <td>
                                <div class="input-group-sm">
                                    <input id="i" class="form-control maxInput"  type="number" min="0" value="0">
                                </div>
                            </td>
                        </tr>
                    </table>
                    <table id="sell" style="display:none">
                        <tr class="autoWidth">
                            <td>Score at investment:</td>
                            <td>
                                <div class="input-group-sm">
                                    <input id="s_sc1" type="number" min="0" max ="1" step="0.1" value="0.5" class="maxInput form-control">
                                </div>
                            </td> 
                        </tr>
                        <tr class="autoWidth spaceSmOver">
                            <td>Initial point investment:</td>
                            <td>
                                <div class="input-group-sm">
                                    <input id="s_i" type="number" class="maxInput form-control" min="0" value="0" onkeyup="sell()">
                                </div>
                            </td>
                        </tr>
                        <tr class="spaceMedOver autoWidth">
                            <td>Shares held:</td>
                            <td>
                                <input id="s_sh" type="number" value="0" disabled="disabled"></td>
                        </tr>
                        <tr class="spaceMedOver autoWidth">
                            <td>Current market score:</td>
                            <td>
                                <div class="input-group-sm">
                                    <input id="s_sc2" type="number" min="0" max ="1" step="0.1" value="0.5" class="maxInput form-control">
                                </div>
                            </td> 
                        </tr>
                        <tr class="spaceMedOver autoWidth">
                            <td>Share worth:</td>
                            <td><input id="s_sw" type="number" value="0" disabled="disabled"></td>
                        </tr>
                        <tr class="spaceMedOver autoWidth">
                            <td>Points sold:</td>
                            <td>
                                <div class="input-group-sm">
                                    <input id="s_ps" class="maxInput form-control" type="number" min="0" max ="0" step="1" value="0">
                                </div>
                            </td> 
                        </tr>
                    </table>
                </div>
                <div class="col-md-4 col-sm-6">
                    <h4>Result</h4>
                    <table>                
                        <tr>
                            <td colspan="2">
                                <h5>Market Yes-prices: <span class="open" onclick="openInfo('#priceinfo')"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span><span class="sr-only">Info</span></span></h5>
                                <div id="priceinfo" class="alert alert-info alert-dismissible" style="display:none" role="alert">
                                    <button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                    <strong>The price</strong> is given by:
                                    $$p(S)=k{\e^{S\/b}}/{\e^{S\/b}+\e^{-S\/b}}$$
                                    where $S$ is the net sales in the market.
                                </div>
                            </td>
                        </tr>              
                        <tr class="autoWidth">
                            <td>Before <span class="trTypeT">investment</span>:</td>
                            <td><input id="p1" value="0.5" disabled="disabled"></td> 
                        </tr>
                        <tr class="autoWidth">
                            <td>After <span class="trTypeT">investment</span>:</td>
                            <td><input id="p2" value="0.5" disabled="disabled"></td>
                        </tr>
                        <tr class="spaceOver">
                            <td colspan="2">
                                <h5>Net market sales: <span class="open" onclick="openInfo('#salesinfo')"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span><span class="sr-only">Info</span></span></h5>
                                <div id="salesinfo" class="alert alert-info alert-dismissible" style="display:none" role="alert">
                                    <button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                    <strong>The net market sales</strong> are defined as shares invested in the market, net shares invest in the other market. They can be solved for by using the market price $p$:
                                    $$S(p)=1/2b\l\n({p\/k}/{1-p\/k}).$$
                                </div>
                            </td>
                        </xxtr>              
                    <tr class="autoWidth">
                        <td>Before <span class="trTypeT">investment</span>:</td>
                        <td><input id="s1" value="0" disabled="disabled"></td> 
                    </tr>
                    <tr class="autoWidth">
                        <td>After <span class="trTypeT">investment</span>:</td>
                        <td><input id="s2" value="0" disabled="disabled"></td>
                    </tr>
                    <tr class="spaceOver">
                        <td colspan="2">
                            <h5><span id="impact">Investment</span> impact: <span class="open" onclick="openInfo('#investInfo')"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span><span class="sr-only">Info</span></span></h5>
                            <div id="investInfo" class="alert alert-info alert-dismissible" style="display:none" role="alert">
                                <button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                <strong>The shares <span class="trTypeD">purchased</span></strong> for a given <span class="trTypeT">investment</span> are calculated by integrating the price between current net sales in the market to the final net sales after the <span class="trTypeT">purchase</span>. The value of this must be equal to the points <span class="trTypeD">invested</span>:
                                $$âˆ«_{S_1}^{S_2}p(S)ds=I.$$
                                This is easily solved for $S_2$ and the shares <span class="trTypeD">purchased</span> are $s=S_2-S_1$.
                                <br>
                                <strong>The balance change</strong> is the negative of the points <span class="trTypeID">invested</span>.
                                <br>
                                <strong>The price change</strong> is simply calculated by $p(S_1)-p(S_2)$.
                                <br>
                                <strong>The average price</strong> per share is calculated by $I\/s$.
                            </div>
                        </td>
                    </tr>              
                    <tr class="autoWidth">
                        <td>Shares <span class="trTypeD">purchased</span>:</td>
                        <td><input id="s" value="0" disabled="disabled"></td>
                    </tr>
                    <tr class="autoWidth">
                        <td>Balance change:</td>
                        <td><input id="pc" value="0" disabled="disabled"></td>
                    </tr>
                    <tr class="autoWidth">
                        <td>Price change:</td>
                        <td><input id="p" value="0" disabled="disabled"></td>
                    </tr>
                    <tr class="autoWidth">
                        <td>Average price:</td>
                        <td><input id="avgp" value="0" disabled="disabled"></td>
                    </tr>
                    </table>
            </div>
            <div class="col-md-4 col-sm-12">
                <h3>About</h3>
                <p>This &ldquo;calculator&rdquo; allows you to try see how investing or selling points at different market situations affects your balance and the market itself.</p>
                <p>All calculations are for a market maker based on a logarithmic scoring rule. In the actual markets we will use parameters $b=200$ and $k=100$.</p>
                <h5>Parameters</h5>
                <table>             
                    <tr class="autoWidth">
                        <td>Point value of a share, $k$:</td>
                        <td>
                            <div class="input-group-sm">
                                <input id="k" type="number" class="form-control input" min="0" step="1" value="100">
                            </div>
                        </td> 
                    </tr>
                    <tr class="autoWidth spaceSmOver">
                        <td>Liquidity parameter, $b$:</td>
                        <td>
                            <div class="input-group-sm">
                                <input id="b" type="number" class="form-control input" min="0" step="1" value="200">
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <hr>

            <footer>
                <p>&copy; <a href="mailto:predictionreplication@hhs.se" target="_blank" style="color: black;
    text-decoration: none !important;">The Science Prediction Market Project</a>, 2015</p>
            </footer>
        </div> <!-- /container -->

    <!-- Bootstrap core JavaScript -->
    <!-- ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/js/jquery-1.11.1.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="/js/ie10-viewport-bug-workaround.js"></script>
    <script type="text/javascript" src="/js/convert.js"></script>
    <script type="text/javascript" src="/js/jqmath-etc-0.4.2.min.js"></script>
    </body>
</html>
