<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="">
        <link rel="icon" href="/favicon.ico">

        <title>BE-RP: Prediction Markets</title>


        <link rel="stylesheet" href="/stylesheets/bootstrap.min.css">

        <!-- Custom styles for this template -->
        <link rel="stylesheet" href="/stylesheets/market.css">
        <link rel="stylesheet" href="/stylesheets/style.css">
        <link rel="stylesheet" href="/stylesheets/jqmath-0.4.0.css">


    </head>

    <body>
        <!-- Navbar -->
        <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/">BE-RP: Prediction markets</a>
                </div>
                <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <li id="home"><a href="/">Home</a></li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Replication info<span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="/repoverview.html">Project overview</a></li>
                                <li><a href="/repdetails.html">Project details</a></li>
                                <li id="studies"><a href="/studies.html">Included studies</a></li>
                            </ul>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Market info<span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="/instructions.html">Trading instructions</a></li>
                                <li class="active"><a href="/calculator.html">Market calculator</a></li>
                            </ul>
                        </li>
                        <li id="people"><a href="/people.html">People</a></li>
                        <li id="participate"><a href="/participate.html">Participate</a></li>
                    </ul>
                </div><!--/.navbar-collapse -->
            </div>
        </div>

        <div class="container">
            <div class="page-header">
                <h1>Market calculator</h1>
            </div>
            <!-- Example row of columns -->
            <div class="row">
                <div class="col-md-4 col-sm-6">
                    <h4>Input</h4>
                    <form id="transaction">
                        <p>Type of transaction:<br>
                            <select type="multiple" id="type">
                                <option value="invest" selected="selected">Invest tokens</option>
                                <option value="sell">Sell invested tokens</option>
                            </select>
                        </p>
                    </form>
                    <table id="invest">
                        <tr class="autoWidth">
                            <td>Current position score:</td>
                            <td>
                                <div class="input-group input-group-sm">
                                    <input id="sc" class="form-control maxInput" type="number" min="0" max ="100" step="0.1" value="50" aria-describedby="basic-addon2">
                                    <span class="input-group-addon" id="basic-addon2">%</span>
                                </div>
                            </td>
                        </tr>
                        <tr class="autoWidth spaceSmOver">
                            <td>Token investment:</td>
                            <td>
                                <div class="input-group-sm">
                                    <input id="i" class="form-control maxInput"  type="number" min="0" value="0">
                                </div>
                            </td>
                        </tr>
                    </table>
                    <table id="sell" style="display:none">
                        <tr class="autoWidth">
                            <td>Score at investment:</td>
                            <td>
                                <div class="input-group input-group-sm">
                                    <input id="s_sc1" type="number" min="0" max ="100" step="1" value="50" class="maxInput form-control">
                                    <span class="input-group-addon" id="basic-addon2">%</span>
                                </div>
                            </td>
                        </tr>
                        <tr class="autoWidth spaceSmOver">
                            <td>Initial token investment:</td>
                            <td>
                                <div class="input-group-sm">
                                    <input id="s_i" type="number" class="maxInput form-control" min="0" value="0" onkeyup="sell()">
                                </div>
                            </td>
                        </tr>
                        <tr class="spaceMedOver autoWidth">
                            <td>Shares held:</td>
                            <td>
                                <div class="calc-output"><span id="s_sh">0</span></div>
                            </td>
                        </tr>
                        <tr class="spaceMedOver autoWidth">
                            <td>Current position score:</td>
                            <td>
                                <div class="input-group input-group-sm">
                                    <input id="s_sc2" type="number" min="0" max ="100" step="1" value="50" class="maxInput form-control">
                                    <span class="input-group-addon" id="basic-addon2">%</span>
                                </div>
                            </td> 
                        </tr>
                        <tr class="spaceMedOver autoWidth">
                            <td>Share worth:</td>
                            <td>
                                <div class="calc-output"><span id="s_sw">0</span></div>
                            </td>
                        </tr>
                        <tr class="spaceMedOver autoWidth">
                            <td>Tokens sold:</td>
                            <td>
                                <div class="input-group-sm">
                                    <input id="s_ps" class="maxInput form-control" type="number" min="0" max ="0" step="1" value="0">
                                </div>
                            </td> 
                        </tr>
                    </table>
                </div>

                <div class="col-md-4 col-sm-6">
                    <h4>Result</h4>
                    <table>                
                        <tr>
                            <td colspan="2">
                                <h5>Position score: <span class="open" onclick="openInfo('#priceinfo')"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span><span class="sr-only">Info</span></span></h5>
                                <div id="priceinfo" class="alert alert-info alert-dismissible" style="display:none" role="alert">
                                    <button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                    <strong>The score</strong> is given by:
                                    $$p(S)=100·{\e^{S\/b}}/{\e^{S\/b}+1}$$
                                    where $S$ are the net position sales.
                                </div>
                            </td>
                        </tr>              
                        <tr class="autoWidth">
                            <td>Before <span class="trTypeT">investment</span>:</td>
                            <td>
                                    <div class="calc-output"><span id="p1">50</span> %</div>
                            </td>
                        </tr>
                        <tr class="autoWidth">
                            <td>After <span class="trTypeT">investment</span>:</td>
                            <td>
                                <div class="calc-output"><span id="p2">50</span> %</div>
                            </td>
                        </tr>
                        <tr class="spaceOver">
                            <td colspan="2">
                                <h5>Net position sales: <span class="open" onclick="openInfo('#salesinfo')"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span><span class="sr-only">Info</span></span></h5>
                                <div id="salesinfo" class="alert alert-info alert-dismissible" style="display:none" role="alert">
                                    <button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                    <strong>The net position sales</strong> are defined as shares invested in the position, net shares invested in the other position. They can be solved for by using the position score $p$:
                                    $$S(p)=b·\l\n({p\/100}/{1-p\/100}).$$
                                </div>
                            </td>
                        </xxtr>              
                    <tr class="autoWidth">
                        <td>Before <span class="trTypeT">investment</span>:</td>
                        <td>
                            <div class="calc-output"><span id="s1">0</span></div>
                    </tr>
                    <tr class="autoWidth">
                        <td>After <span class="trTypeT">investment</span>:</td>
                        <td>
                            <div class="calc-output"><span id="s2">0</span></div>
                    </tr>
                    <tr class="spaceOver">
                        <td colspan="2">
                            <h5><span id="impact">Investment</span> impact: <span class="open" onclick="openInfo('#investInfo')"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span><span class="sr-only">Info</span></span></h5>
                            <div id="investInfo" class="alert alert-info alert-dismissible" style="display:none" role="alert">
                                <button type="button" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                <strong>The shares <span class="trTypeD">purchased</span></strong> for a given <span class="trTypeT">investment</span> are calculated by integrating the price between current net sales in the position and the final net sales after the <span class="trTypeT">purchase</span>. The value of this must be equal to the tokens <span class="trTypeD">invested</span>:
                                $$∫_{S_1}^{S_2}p(S)\d s=I.$$
                                This is easily solved for $S_2$ and the shares <span class="trTypeD">purchased</span> are $s=S_2-S_1$.
                                <br>
                                <strong>The balance change</strong> is the negative of the tokens <span class="trTypeID">invested</span>.
                                <br>
                                <strong>The score change</strong> is simply calculated by $p(S_1)-p(S_2)$.
                                <br>
                                <strong>The average score</strong> per share is calculated by $I\/s$.
                            </div>
                        </td>
                    </tr>              
                    <tr class="autoWidth">
                        <td>Shares <span class="trTypeD">purchased</span>:</td>
                        <td>
                            <div class="calc-output"><span id="s">0</span></div>
                        </td>
                    </tr>
                    <tr class="autoWidth">
                        <td>Balance change:</td>
                        <td>
                            <div class="calc-output"><span id="pc">0</span></div>
                        </td>
                    </tr>
                    <tr class="autoWidth">
                        <td>Score change:</td>
                        <td>
                            <div class="calc-output"><span id="p">0</span> (pp)</div>
                        </td>
                    </tr>
                    <tr class="autoWidth">
                        <td>Average score:</td>
                        <td>
                            <div class="calc-output"><span id="avgp">0</span> %</div>
                        </td>
                    </tr>
                    </table>
            </div>
            <div class="col-md-4 col-sm-12">
                <h3>About</h3>
                <p>This &ldquo;calculator&rdquo; allows you to try see how investing or selling tokens at different market situations affects your balance and the market itself. Remember that you start out with 100 tokens.</p>
                <p>All calculations are for a market maker based on a logarithmic scoring rule. In the actual markets we use parameters $b=200$ and $k=1$.</p>
                <h5>Parameters</h5>
                <table>             
                    <tr class="autoWidth">
                        <td>Token value of a share, $k$:</td>
                        <td>
                            <div class="input-group-sm">
                                <input id="k" type="number" class="form-control input" min="0" step="1" value="1">
                                       </div>
                                </td> 
                    </tr>
                    <tr class="autoWidth spaceSmOver">
                        <td>Liquidity parameter, $b$:</td>
                        <td>
                            <div class="input-group-sm">
                                <input id="b" type="number" class="form-control input" min="0" step="1" value="200">
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <hr>

        <footer>
            <p>&copy; <a href="mailto:predictionreplication@hhs.se" target="_blank" style="color: black;
                text-decoration: none !important;">The Science Prediction Market Project</a>, 2015</p>
        </footer>
        </div> <!-- /container -->

        <!-- Bootstrap core JavaScript -->
        <!-- ================================================== -->
        <!-- Placed at the end of the document so the pages load faster -->
        <script src="/js/jquery-1.11.1.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
        <script src="/js/ie10-viewport-bug-workaround.js"></script>
        <script type="text/javascript" src="/js/convert.js"></script>
        <script type="text/javascript" src="/js/jqmath-etc-0.4.2.min.js"></script>
    </body>
</html>
